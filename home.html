<!DOCTYPE html>
<html lang="ru" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>COOLZM ‚Äî –ü–∞–±–ª–∏–∫ –∏ –ó–æ–º–±–∏ —Å–µ—Ä–≤–µ—Ä—ã</title>
    <meta
      name="description"
      content="CS 1.6 —Å–µ—Ä–≤–µ—Ä—ã: –ü–∞–±–ª–∏–∫ –∏ –ó–æ–º–±–∏. –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –ø—Ä–∞–≤–∏–ª–∞, –∫–æ–º–∞–Ω–¥—ã, —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ. Dark/Light. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ localStorage."
    />
    <meta
      name="google-site-verification"
      content="Qw5cPzkqypRHMAOr3ECnOIVeLAyU0Hh4j4ZMSFHLsKc"
    />
    <meta name="color-scheme" content="dark light" />
    <link rel="icon" href="logo.png" />

    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
      (function (m, e, t, r, i, k, a) {
        m[i] =
          m[i] ||
          function () {
            (m[i].a = m[i].a || []).push(arguments);
          };
        m[i].l = 1 * new Date();
        for (var j = 0; j < document.scripts.length; j++) {
          if (document.scripts[j].src === r) {
            return;
          }
        }
        (k = e.createElement(t)),
          (a = e.getElementsByTagName(t)[0]),
          (k.async = 1),
          (k.src = r),
          a.parentNode.insertBefore(k, a);
      })(
        window,
        document,
        "script",
        "https://mc.yandex.ru/metrika/tag.js?id=104046718",
        "ym"
      );

      ym(104046718, "init", {
        ssr: true,
        webvisor: true,
        clickmap: true,
        ecommerce: "dataLayer",
        accurateTrackBounce: true,
        trackLinks: true,
      });
    </script>
    <noscript
      ><div>
        <img
          src="https://mc.yandex.ru/watch/104046718"
          style="position: absolute; left: -9999px"
          alt=""
        /></div
    ></noscript>
    <!-- /Yandex.Metrika counter -->
    <link rel="stylesheet" href="./index_res.css" />
  </head>
  <body>
    <header>
      <nav class="nav">
        <div class="brand">
          <div class="logo">
            <img style="width: 48px;height: 48px; border-radius:10px;"src="./logo.png" alt="" />
          </div>
          <div>
            <div style="font-weight: 800">COOLZM</div>
            <div class="muted">–ü–∞–±–ª–∏–∫ –∏ –ó–æ–º–±–∏ —Å–µ—Ä–≤–µ—Ä—ã</div>
          </div>
        </div>

        <!-- ‚úÖ BURGER TUGMASI -->
        <button id="burger" class="burger" aria-label="–ú–µ–Ω—é">
          <span></span><span></span><span></span>
        </button>

        <!-- ‚úÖ Asl menyu -->
        <div class="controls" id="menu">
          <button id="theme" class="btn">–¢—ë–º–Ω–∞—è</button>
          <a class="btn primary" href="./reports.html">–ñ–∞–ª–æ–±—ã</a>
          <a
            class="btn primary"
            style="
              background: transparent;
              border-color: #00ff7f;
              color: #00ff7f;
            "
            href="./rules.html"
            >–ü—Ä–∞–≤–∏–ª–∞</a
          >
          <a id="shop" class="btn primary" href="./shop.html" rel="noopener"
            >–ú–∞–≥–∞–∑–∏–Ω</a
          >
          <a
            id="logout"
            class="btn primary"
            style="
              background: transparent;
              border-color: #00ff7f;
              color: #00ff7f;
            "
            href="./index.html"
            rel="noopener"
            >–í—ã–π—Ç–∏</a
          >
        </div>
      </nav>
    </header>

    <main>
      <section class="hero scanline">
        <div class="headline">CS 1.6 COOLZM ‚Äî –ü–ê–ë–õ–ò–ö & –ó–û–ú–ë–ò</div>
        <p class="sub">
          –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª Steam, —á–∏—Ç–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –∫–æ–º–∞–Ω–¥—ã. –í—Å—ë –Ω–∞
          –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
        </p>
        <div class="badges">
          <span class="badge">–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: RU</span>
          <span class="badge">–¢—ë–º–Ω–∞—è / –°–≤–µ—Ç–ª–∞—è</span>
          <span class="badge">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage</span>
          <span class="badge">–°—Ç–∏–ª—å HUD CS 1.6</span>
        </div>
      </section>

      <section class="grid">
        <!-- Servers -->
        <article class="card half">
          <h3>PUBLIC</h3>
          <div class="server">
            <div class="kv">
              <div>IP:</div>
              <div>
                <span id="pubIp">93.191.11.211</span>:<span id="pubPort"
                  >27021</span
                >
              </div>
            </div>
            <div class="kv">
              <div>–ü–∞—Ä–æ–ª—å:</div>
              <div><span id="pubPass">‚Äî</span></div>
            </div>
            <div class="kv">
              <div>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:</div>
              <div>
                <a id="pubLink" class="pill" href="#">steam://connect</a>
                <button class="btn" data-copy="#pubIp">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å IP</button>
              </div>
            </div>
            <div class="sep"></div>
            <ul class="list">
              <li class="li">
                <div class="icon">‚òÖ</div>
                <div>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π defuse/hostage, —á–µ—Å—Ç–Ω–∞—è –∏–≥—Ä–∞, –∞–Ω—Ç–∏—á–∏—Ç.</div>
              </li>
              <li class="li">
                <div class="icon">‚å®</div>
                <div>–ö–æ–º–∞–Ω–¥—ã: /rtv /rs /vips /maps.</div>
              </li>
              <li class="li">
                <div class="icon">‚öô</div>
                <div>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ net_graph –∏ rate.</div>
              </li>
            </ul>
          </div>
        </article>

        <article class="card half">
          <h3>ZOMBIE</h3>
          <div class="server">
            <div class="kv">
              <div>IP:</div>
              <div>
                <span id="zmIp">46.174.52.14</span>:<span id="zmPort"
                  >27255</span
                >
              </div>
            </div>
            <div class="kv">
              <div>–ü–∞—Ä–æ–ª—å:</div>
              <div><span id="zmPass">‚Äî</span></div>
            </div>
            <div class="kv">
              <div>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:</div>
              <div>
                <a id="zmLink" class="pill" href="#">steam://connect</a>
                <button class="btn" data-copy="#zmIp">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å IP</button>
              </div>
            </div>
            <div class="sep"></div>
            <ul class="list">
              <li class="li">
                <div class="icon">üßü</div>
                <div>
                  Biohazard Classic: –≤—ã–∂–∏–≤–∞–π –∏–ª–∏ –∑–∞—Ä–∞–∂–∞–π. –ï—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã.
                </div>
              </li>
              <li class="li">
                <div class="icon">üí¨</div>
                <div>–ö–æ–º–∞–Ω–¥—ã: /rtv /rs /vips /maps.</div>
              </li>
              <li class="li">
                <div class="icon">üîß</div>
                <div>–ó–∞–ø—Ä–µ—â–µ–Ω—ã –ª–∞–∑–µ—Ä–Ω—ã–µ –º–∏–Ω—ã –∏ –±–∞–≥-–∞–±—É–∑.</div>
              </li>
            </ul>
          </div>
        </article>

        <!-- How to connect -->
        <article class="card third">
          <h3>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</h3>
          <ol class="list">
            <li class="li">
              <div class="icon">‚ë†</div>
              <div>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Steam (–∫–ª–∏–µ–Ω—Ç CS 1.6/GoldSrc).</div>
            </li>
            <li class="li">
              <div class="icon">‚ë°</div>
              <div>
                –ù–∞–∂–º–∏—Ç–µ —Å—Å—ã–ª–∫—É <span class="kbd">steam://connect</span> ‚Äî –∏–≥—Ä–∞
                –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é.
              </div>
            </li>
            <li class="li">
              <div class="icon">‚ë¢</div>
              <div>–õ–∏–±–æ –¥–æ–±–∞–≤—å—Ç–µ IP:PORT –≤ ¬´–ò–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª –∏ –ø–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å.</div>
            </li>
          </ol>
          <p class="muted">
            –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª Steam.
          </p>
        </article>

        <!-- Rules -->
        <article class="card third">
          <h3>–ü—Ä–∞–≤–∏–ª–∞ (–∫—Ä–∞—Ç–∫–æ)</h3>
          <ul class="list">
            <li class="li">
              <div class="icon">‚úî</div>
              <div>–ó–∞–ø—Ä–µ—â–µ–Ω—ã —á–∏—Ç—ã, —ç–∫—Å–ø–ª–æ–π—Ç—ã –∏ –±–∞–≥-–∞–±—É–∑.</div>
            </li>
            <li class="li">
              <div class="icon">‚úî</div>
              <div>–£–≤–∞–∂–∞–π—Ç–µ –∏–≥—Ä–æ–∫–æ–≤: –±–µ–∑ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–π, —Å–ø–∞–º–∞ –∏ —Ä–µ–∫–ª–∞–º—ã.</div>
            </li>
            <li class="li">
              <div class="icon">‚úî</div>
              <div>–ò–≥—Ä–∞–π—Ç–µ –ø–æ —Ü–µ–ª—è–º –∫–æ–º–∞–Ω–¥—ã; –Ω–µ –º–µ—à–∞–π—Ç–µ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ.</div>
            </li>
            <li class="li">
              <div class="icon">‚úî</div>
              <div>
                Zombie: –Ω–∏–∫–∞–∫–∏—Ö –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö –±–∏–Ω–¥–æ–≤/–±–∞–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä,
                –ª–∞–∑–µ—Ä–º–∞–π–Ω-–∞–±—É–∑).
              </div>
            </li>
          </ul>
          <p class="muted">
            –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π; –Ω–∞—Ä—É—à–µ–Ω–∏—è ‚Äî
            –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ/–±–∞–Ω.
          </p>
        </article>

        <!-- Useful -->
        <article class="card third">
          <h3>–ü–æ–ª–µ–∑–Ω–æ–µ</h3>
          <ul class="list">
            <li class="li">
              <div class="icon">‚å®</div>
              <div>–ü—Ä–∏–º–µ—Ä bind: <span class="kbd">bind F2 "rebuy"</span></div>
            </li>
            <li class="li">
              <div class="icon">‚ö°</div>
              <div>
                –°–µ—Ç—å: <span class="kbd">rate 25000</span>,
                <span class="kbd">cl_updaterate 101</span>,
                <span class="kbd">cl_cmdrate 101</span>
              </div>
            </li>
            <li class="li">
              <div class="icon">‚¨á</div>
              <div>–ß–∏—Å—Ç—ã–π –∫–ª–∏–µ–Ω—Ç CS 1.6:</div>
              <a
                class="download_link"
                href="https://all-cs.ru/sborki/CS16_Setup.exe"
                >–°–∫–∞—á–∞—Ç—å –º–æ–∂–Ω–æ —Ç—É—Ç</a
              >
            </li>
          </ul>
        </article>

        <!-- Contacts -->
        <article
          class="card"
          style="
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            flex-direction: column;
          "
        >
          <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –°–æ–æ–±—â–µ—Å—Ç–≤–æ</h3>
          <div class="socials">
            <a
              class="social"
              id="tgLink"
              href="#"
              target="_blank"
              rel="noopener"
              >Telegram</a
            >
            <a
              class="social"
              id="igLink"
              href="#"
              target="_blank"
              rel="noopener"
              >Instagram</a
            >
            <a
              class="social"
              id="dcLink"
              href="#"
              target="_blank"
              rel="noopener"
              >Discord</a
            >
          </div>
        </article>
      </section>
    </main>

    <footer>
      <div>¬© <span id="year"></span> CS 1.6 Community</div>
    </footer>

    <script>
      // ======= helpers/state =======
      const $ = (q, ctx = document) => ctx.querySelector(q);
      const $$ = (q, ctx = document) => Array.from(ctx.querySelectorAll(q));
      const state = {
        theme: localStorage.getItem("theme") || "dark",
        shop: localStorage.getItem("shop") || "./shop.html",
        rule: localStorage.getItem("rule") || "./rules.html",
        tg: localStorage.getItem("tg") || "https://t.me/cs_chuvashi",
        ig: localStorage.getItem("ig") || "https://instagram.com/1mln_edits",
        dc: localStorage.getItem("dc") || "https://discord.gg/xTaE3C97",
        servers: JSON.parse(localStorage.getItem("servers") || "{}") || {},
      };

      const defaults = {
        pub: { ip: "93.191.11.211", port: "27021", pass: "" },
        zm: { ip: "46.174.52.14", port: "27255", pass: "" },
      };

      function applyTheme() {
        document.documentElement.setAttribute("data-theme", state.theme);
        $("#theme").textContent = state.theme === "dark" ? "Light" : "Dark";
      }

      function getServer(kind) {
        const s = state.servers[kind] || defaults[kind];
        return {
          ip: s.ip || defaults[kind].ip,
          port: s.port || defaults[kind].port,
          pass: s.pass || "",
        };
      }

      function makeSteamLink(s) {
        // steam://connect/<IP>[:<port>][/<password>]
        let url = `steam://connect/${s.ip}`;
        if (s.port) url += `:${s.port}`;
        if (s.pass) url += `/${s.pass}`;
        return url;
      }

      function renderServers() {
        const pub = getServer("pub");
        const zm = getServer("zm");
        $("#pubIp").textContent = pub.ip;
        $("#pubPort").textContent = pub.port;
        $("#pubPass").textContent = pub.pass || "‚Äî";
        $("#zmIp").textContent = zm.ip;
        $("#zmPort").textContent = zm.port;
        $("#zmPass").textContent = zm.pass || "‚Äî";
        $("#pubLink").href = makeSteamLink(pub);
        $("#zmLink").href = makeSteamLink(zm);
      }

      // ======= init/events =======
      document.addEventListener("DOMContentLoaded", () => {
        document.documentElement.lang = "ru";
        applyTheme();
        renderServers();
        // === Burger menyu ===
        const burger = document.getElementById("burger");
        const menu = document.getElementById("menu");

        burger.addEventListener("click", () => {
          burger.classList.toggle("active");
          menu.classList.toggle("active");
        });

        $("#shop").href = state.shop;
        $("#tgLink").href = state.tg;
        $("#igLink").href = state.ig;
        $("#dcLink").href = state.dc;
        $("#year").textContent = new Date().getFullYear();

        // theme toggle
        $("#theme").addEventListener("click", () => {
          state.theme = state.theme === "dark" ? "light" : "dark";
          localStorage.setItem("theme", state.theme);
          applyTheme();
        });

        // copy ip buttons
        $$("[data-copy]").forEach((btn) =>
          btn.addEventListener("click", () => {
            const target = $(btn.getAttribute("data-copy"));
            const ip = target.textContent.trim();
            navigator.clipboard?.writeText(ip);
            btn.classList.add("focus");
            setTimeout(() => btn.classList.remove("focus"), 600);
          })
        );
      });
      // === Foydalanuvchi holati ===
      const user = JSON.parse(localStorage.getItem("user"));
      if (!user) {
        window.location.href = "index.html"; // Login sahifaga qaytar
      } else {
        // "–í—ã–π—Ç–∏" tugmasiga ismni qo‚Äòshamiz
        const logoutBtn = document.querySelector(
          'a[href="./index.html"], a[href="index.html"]'
        );
        if (logoutBtn) {
          logoutBtn.textContent = "–í—ã–π—Ç–∏ (" + user.name + ")";
          logoutBtn.addEventListener("click", () => {
            localStorage.removeItem("user");
            window.location.href = "index.html";
          });
        }
      }
    </script>
    <!-- Supabase JS (v2) -->
    <script type="module">
      import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

      // === –ó–ê–ú–ï–ù–ò –≠–¢–ò –î–í–ï –°–¢–†–û–ö–ò –ù–ê –°–í–û–ò –î–ê–ù–ù–´–ï ===
      const SUPABASE_URL = "https://mhpfuejghznibsqccakk.supabase.co";
      const SUPABASE_ANON =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ocGZ1ZWpnaHpuaWJzcWNjYWtrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3Njg0MDcsImV4cCI6MjA3NjM0NDQwN30.9FSwygoMxA98_zbZQE6hVQ_MJxOTMUbqGTjo68AkKXc";

      const sb = createClient(SUPABASE_URL, SUPABASE_ANON);

      // –†–µ–Ω–¥–µ—Ä –±–ª–æ–∫–∞ –≤ —Ñ—É—Ç–µ—Ä–µ (–µ—Å–ª–∏ —Ç—ã —É–∂–µ —Å–æ–∑–¥–∞—ë—à—å #visitCounter ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏ —ç—Ç–æ—Ç –±–ª–æ–∫)
      const footer = document.querySelector("footer");
      let counterEl = document.getElementById("visitCounter");
      if (!counterEl) {
        counterEl = document.createElement("div");
        counterEl.id = "visitCounter";
        counterEl.innerHTML = `
      <span class="counter-icon">üë•</span>
      <span class="counter-label">–ü–æ—Å–µ—â–µ–Ω–∏–π:</span>
      <span class="counter-value total">‚Äî</span>
      <span class="counter-sep"> | </span>
      <span class="counter-label">–û–Ω–ª–∞–π–Ω:</span>
      <span class="counter-value online">‚Äî</span>
    `;
        footer.appendChild(counterEl);
      }

      // === 1) –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–æ—Å–µ—â–µ–Ω–∏—è: –∞—Ç–æ–º–∞—Ä–Ω—ã–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç + –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
      async function bumpAndShow() {
        // "home" –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É: 'home', 'shop', 'rules', –ª–∏–±–æ 'global'
        const { data, error } = await sb.rpc("increment_counter", {
          counter_id: "global",
        });
        if (error) {
          console.error("increment_counter error:", error);
          return;
        }
        document.querySelector(".counter-value.total").textContent =
          Number(data).toLocaleString();
        counterEl.classList.add("visible");
      }

      // === 2) –û–Ω–ª–∞–π–Ω –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å: Presence-–∫–∞–Ω–∞–ª
      const uid = crypto.randomUUID
        ? crypto.randomUUID()
        : Math.random().toString(36).slice(2);
      const channel = sb.channel("online-room", {
        config: { presence: { key: uid } },
      });

      channel.on("presence", { event: "sync" }, () => {
        // –°—Ç—Ä—É–∫—Ç—É—Ä–∞: { userKey: [{meta...},{...}], ... }
        const state = channel.presenceState();
        const online = Object.keys(state).length;
        const el = document.querySelector(".counter-value.online");
        if (el) el.textContent = String(online);
      });

      await channel.subscribe(async (status) => {
        if (status === "SUBSCRIBED") {
          // –ù–∞—á–∏–Ω–∞–µ–º ¬´—Å–≤–µ—Ç–∏—Ç—å—Å—è¬ª –≤ –æ–Ω–ª–∞–π–Ω–µ
          await channel.track({ online_at: new Date().toISOString() });
        }
      });

      // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–∫–∞–∑ –≤–∏–∑–∏—Ç–æ–≤
      bumpAndShow();
    </script>
    <!-- üí¨ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –ß–ê–¢ -->
    <div id="chatWidget">
      <button id="chatToggle">üí¨</button>

      <div id="chatBox" class="hidden">
        <div id="chatHeader">–ì–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç</div>
        <div id="chatMessages"></div>
        <div id="chatInputArea">
          <input
            type="text"
            id="chatInput"
            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
          />
          <button id="sendBtn">‚û§</button>
        </div>
      </div>
    </div>
    <script type="module">
      import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

      const SUPABASE_URL = "https://mhpfuejghznibsqccakk.supabase.co";
      const SUPABASE_ANON =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ocGZ1ZWpnaHpuaWJzcWNjYWtrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3Njg0MDcsImV4cCI6MjA3NjM0NDQwN30.9FSwygoMxA98_zbZQE6hVQ_MJxOTMUbqGTjo68AkKXc";

      const sb = createClient(SUPABASE_URL, SUPABASE_ANON);

      const chatBox = document.getElementById("chatBox");
      const chatToggle = document.getElementById("chatToggle");
      const sendBtn = document.getElementById("sendBtn");
      const chatInput = document.getElementById("chatInput");
      const chatMessages = document.getElementById("chatMessages");

      chatToggle.addEventListener("click", () => {
        chatBox.classList.toggle("active");
      });

      const user = JSON.parse(localStorage.getItem("user"));
      const username = user?.name || "–ì–æ—Å—Ç—å";

      // === –ó–ê–ì–†–£–ó–ö–ê –ò–°–¢–û–†–ò–ò ===
      async function loadMessages() {
        const { data, error } = await sb
          .from("chat_messages")
          .select("*")
          .order("created_at", { ascending: true })
          .limit(100);

        if (error) {
          console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:", error.message);
          return;
        }
        chatMessages.innerHTML = "";
        data.forEach(renderMessage);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function renderMessage(msg) {
        const el = document.createElement("div");
        el.classList.add("msg");
        el.innerHTML = `<b>${msg.username}:</b> ${msg.text}`;
        chatMessages.appendChild(el);
      }

      // === –û–¢–ü–†–ê–í–ö–ê ===
      async function sendMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        chatInput.value = "";

        const { error } = await sb
          .from("chat_messages")
          .insert([{ username, text }]);

        if (error) console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:", error.message);
      }

      sendBtn.addEventListener("click", sendMessage);
      chatInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendMessage();
      });

      // === LIVE-–û–ë–ù–û–í–õ–ï–ù–ò–ï (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏) ===
      const channel = sb
        .channel("realtime:public:chat_messages")
        .on(
          "postgres_changes",
          {
            event: "INSERT",
            schema: "public",
            table: "chat_messages",
          },
          (payload) => {
            renderMessage(payload.new);
            chatMessages.scrollTop = chatMessages.scrollHeight;
          }
        )
        .subscribe((status) => {
          if (status === "SUBSCRIBED") {
            console.log("‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —á–∞—Ç –∞–∫—Ç–∏–≤–Ω–∞");
          }
        });

      // === –ü–ï–†–í–û–ù–ê–ß–ê–õ–¨–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê ===
      loadMessages();
    </script>
  </body>
</html>
